function getRooms(){var JsonData={"userName":getCookie("userName"),"password":getCookie("password"),};$.ajax({cache:true,type:"POST",url:getUrl()+"/HotelPMS/RoomSelectServlet",data:{"strSelectRoom":JSON.stringify(JsonData)},async:false,error:function(request){alert("获取状态失败，请稍后")},success:function(data){var obj=JSON.parse(data);var objs=eval(data);for(var j=0;j<objs.length;j++){var aa=new Array();aa[0]=objs[j].roomName;aa[1]=objs[j].roomNumber;setLeft(aa);var now=new Date();var year=now.getFullYear();var month=now.getMonth()+1;var day=now.getDate();var nowNowDate=year+"-"+month+"-"+day;setTable0(1,getStatus(getCookie("userName"),getCookie("password"),aa[1],nowNowDate),aa[1],getData(nowNowDate))}}});return false}function setLeft(A){setLeftTable(1,A)}function setLeftTable(F,A){var C=document.getElementById("table1");var D;var E;for(var B=0;B<F;B++){D=document.createElement("tr");document.getElementById("table1").appendChild(D);for(var G=0;G<A.length;G++){E=document.createElement("td");E.innerText=A[G];D.appendChild(E)}D.appendChild(E)}}function setTable0(I,B,E,C){var H=document.getElementById("table2");var G;var D;for(var F=0;F<I;F++){G=document.createElement("tr");document.getElementById("table2").appendChild(G);G.id=E;for(var E=0;E<B.length;E++){D=document.createElement("td");D.onclick=function(){getColumnDetail(this)};D.id=C[E];var A=new Array();A=B[E].split("-");if(A[0]=="1"){D.innerText="已预定\n"+A[1];D.bgColor="#ccc"}else{if(A[0]=="2"){D.innerText="已入住\n"+A[1];D.bgColor="#5FB878"}}G.appendChild(D)}G.appendChild(D)}}function m(A){layui.laydate(A)}layui.use("laydate",function(){var A=layui.laydate});function getColumnDetail(A){setCookie("Date",A.id);setCookie("roomNumber",A.parentNode.id);var B=new Array();B=A.innerHTML.split("<br>");if(B[0]=="已预定"){layer.open({type:1,area:["950px","500px"],content:'<div><iframe src="./booking.html" width="950px" height="450px" scrolling="no" frameborder="0"name="framelayer"> </iframe></div>'})}else{if(B[0]=="已入住"){layer.open({type:1,area:["950px","500px"],content:'<div><iframe src="./checkin.html" width="950px" height="450px" scrolling="no" frameborder="0"name="framelayer"> </iframe></div>'});alert("已入住")}else{layer.open({type:1,area:["950px","500px"],content:'<div><iframe src="./hotelStatusSetupLayer.html" width="950px" height="450px" scrolling="no" frameborder="0"name="framelayer"> </iframe></div>'})}}}function setTable(F,A){var C=document.getElementById("table2");var D;var E;for(var B=0;B<F;B++){D=document.createElement("tr");document.getElementById("table2").appendChild(D);for(var G=0;G<A.length;G++){E=document.createElement("td");E.onclick=function(){getColumnDetail(this)};E.innerText=A[G];D.appendChild(E)}}}function setTableHeader(F,A){var C=document.getElementById("table2");C.innerHTML="";var D;var E;for(var B=0;B<F;B++){D=document.createElement("tr");document.getElementById("table2").appendChild(D);for(var G=0;G<A.length;G++){E=document.createElement("td");E.innerText=A[G];D.appendChild(E)}}}function setTableHeaderAuto(){var E=new Array();for(var A=0;A<31;A++){var F=new Date();var G=new Array("日","一","二","三","四","五","六");F.setDate(F.getDate()+A);var B=F.getMonth()+1;var D=F.getDate();var C=F.getDay();E[A]=B+"-"+D+"-"+G[C]}setTableHeader(1,E)}function getData(A){var B=new Array();for(var F=0;F<31;F++){var C=new Date(A);var E=new Array("日","一","二","三","四","五","六");C.setDate(C.getDate()+F);var H=C.getFullYear();var D=C.getMonth()+1;var G=C.getDate();var I=C.getDay();B[F]=H+"-"+D+"-"+G}return B}function setData(A){var B=new Array();for(var F=0;F<31;F++){var C=new Date(A);var E=new Array("日","一","二","三","四","五","六");C.setDate(C.getDate()+F);var D=C.getMonth()+1;var G=C.getDate();var H=C.getDay();B[F]=D+"-"+G+"-"+E[H]}setTableHeader(1,B)}function getPreMonth(K){var G=K.split("-");var F=G[0];var B=G[1];var C=G[2];var A=new Date(F,B,0);A=A.getDate();var I=F;var E=parseInt(B)-1;if(E==0){I=parseInt(I)-1;E=12}var J=C;var D=new Date(I,E,0);D=D.getDate();if(J>D){J=D}if(E<10){E="0"+E}var H=I+"-"+E+"-"+J;return H}function getNextMonth(K){var G=K.split("-");var F=G[0];var B=G[1];var C=G[2];var A=new Date(F,B,0);A=A.getDate();var I=F;var E=parseInt(B)+1;if(E==13){I=parseInt(I)+1;E=1}var J=C;var D=new Date(I,E,0);D=D.getDate();if(J>D){J=D}if(E<10){E="0"+E}var H=I+"-"+E+"-"+J;return H}function getNowDate(){var F=new Date();var D=F.getFullYear();var C=F.getMonth()+1;var B=F.getDate();var E=D+"-"+C+"-"+B;var A=document.getElementById("nowTimeChoose");A.value=E}function leftChoose(){var A=document.getElementById("nowTimeChoose");A.value=getPreMonth(A.value);setData(A.value);buttonGetRooms(A.value)}function nowTimeChoose(B){var A=document.getElementById("nowTimeChoose");setData(A.value);buttonGetRooms(A.value)}function rightChoose(){var A=document.getElementById("nowTimeChoose");A.value=getNextMonth(A.value);setData(A.value);buttonGetRooms(A.value)}function getStatus(D,A,E,B){var C={"userName":D,"password":A,"roomNumber":E,"hasStayDate":B,};var F=new Array();$.ajax({cache:true,type:"POST",url:getUrl()+"/HotelPMS/EditSelectServlet",data:{"strSelectEdit":JSON.stringify(C)},async:false,error:function(G){alert("获取状态失败，请稍后")},success:function(G){F=G.split(", ");return F}});return F}function buttonGetRooms(inDate){var JsonData={"userName":getCookie("userName"),"password":getCookie("password"),};$.ajax({cache:true,type:"POST",url:getUrl()+"/HotelPMS/RoomSelectServlet",data:{"strSelectRoom":JSON.stringify(JsonData)},async:false,error:function(request){alert("获取状态失败，请稍后")},success:function(data){var obj=JSON.parse(data);var objs=eval(data);for(var j=0;j<objs.length;j++){var aa=new Array();aa[0]=objs[j].roomName;aa[1]=objs[j].roomNumber;setTable0(1,getStatus(getCookie("userName"),getCookie("password"),aa[1],inDate),aa[1],getData(inDate))}}});return false};